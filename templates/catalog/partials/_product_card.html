{% load static %}
<div class="product-card-tech w-100 bg-white rounded-3 overflow-hidden position-relative d-flex flex-column h-100">
    
    <!-- Badges -->
    <div class="badges position-absolute top-0 start-0 p-2 z-2">
        {% if product.is_on_sale %}
        <span class="badge bg-purple text-white rounded-pill px-2 py-1 shadow-sm mb-1 d-block" style="font-size: 0.75rem;">
            Save ৳{{ product.discount_amount|floatformat:0 }}
        </span>
        {% endif %}
    </div>

    <!-- Image -->
    <div class="product-image-tech p-3 text-center border-bottom border-light position-relative">
        <a href="{{ product.get_absolute_url }}" class="d-block">
            <div class="ratio ratio-4x3">
                    {% if product.primary_image %}
                <img src="{{ product.primary_image.image.url }}" alt="{{ product.name }}" class="object-fit-contain p-2">
                {% else %}
                <div class="d-flex align-items-center justify-content-center bg-light text-muted h-100">
                    <i class="bi bi-laptop display-6"></i>
                </div>
                {% endif %}
            </div>
        </a>
        
        <!-- Hover Overlay actions (Optional, if we want quick view) -->
    </div>

    <!-- Content -->
    <div class="product-content p-3 d-flex flex-column flex-grow-1">
        <h3 class="product-title h6 mb-3 fw-bold">
            <a href="{{ product.get_absolute_url }}" class="text-dark text-decoration-none hover-primary text-clamp-2">
                {{ product.name }}
            </a>
        </h3>

        <!-- Key Features List -->
        <div class="product-features mb-3 flex-grow-1">
            <ul class="list-unstyled mb-0 small text-muted feature-list">
                {% if product.specifications %}
                    {% for key, value in product.specifications.items|slice:":4" %}
                    <li class="mb-1 d-flex">
                        <i class="bi bi-dot fs-5 text-secondary lh-1 me-1" style="margin-top: -3px;"></i>
                        <span class="text-clamp-1">{{ key }}: {{ value }}</span>
                    </li>
                    {% endfor %}
                {% elif product.short_description %}
                        <div class="small text-muted text-clamp-2 lh-sm" style="font-size: 0.85rem;">
                        {{ product.short_description }}
                        </div>
                {% else %}
                    <!-- No features available -->
                        <span class="small text-muted">View details for more info</span>
                {% endif %}
            </ul>
        </div>

        <div class="border-top border-light pt-3 mt-auto">
            <!-- Price -->
            <div class="text-center mb-3">
                    {% if product.price %}
                    <div class="price-wrapper">
                        <span class="current-price text-primary fw-bold fs-5">৳{{ product.price|floatformat:0 }}</span>
                        {% if product.is_on_sale %}
                        <span class="original-price text-decoration-line-through text-muted ms-2 small">৳{{ product.compare_at_price|floatformat:0 }}</span>
                        {% endif %}
                    </div>
                    {% else %}
                    <span class="text-danger fw-bold">Out of Stock</span>
                    {% endif %}
            </div>

            <!-- Actions -->
            <div class="action-buttons d-flex gap-2 justify-content-center">
                {% if product.price %}
                <button class="btn btn-light-primary btn-sm rounded-pill fw-bold flex-grow-1 d-flex align-items-center justify-content-center gap-2 add-to-cart-btn hover-shadow"
                        data-variant-id="{{ product.get_default_variant.id }}"
                        data-product-name="{{ product.name }}"
                        data-product-price="{{ product.price|default:0 }}">
                    <i class="bi bi-cart-plus-fill"></i> Add to Cart
                </button>
                {% else %}
                    <button class="btn btn-light-secondary btn-sm rounded-pill fw-bold flex-grow-1 disabled" disabled>
                    Out of Stock
                </button>
                {% endif %}
            </div>
        </div>
    </div>
</div>
